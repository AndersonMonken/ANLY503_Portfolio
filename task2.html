<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Anderson Monken" />

<meta name="date" content="2020-10-23" />

<title>task2</title>

<script src="site_libs/header-attrs-2.4.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Anderson Monken ANLY503 Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Course Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data_wrangling.html">Data Wrangling Assignment</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Exploratory Data Analysis Assignment</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="task1.html">Task 1</a>
        </li>
        <li>
          <a href="task2.html">Task 2</a>
        </li>
        <li>
          <a href="task3.html">Task 3</a>
        </li>
        <li>
          <a href="task4.html">Task 4</a>
        </li>
        <li>
          <a href="task5.html">Task 5</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="geospatial.html">Choropleth Assignment</a>
    </li>
    <li>
      <a href="network.html">Network Assignment</a>
    </li>
  </ul>
</li>
<li>
  <a href="project.html">Final Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndersonMonken/ANLY503_Portfolio">Github</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">task2</h1>
<h4 class="author">Anderson Monken</h4>
<h4 class="date">10/23/2020</h4>

</div>


<pre class="python"><code>import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

accounts_data = pd.read_csv(&#39;data/accounts_analytical.csv&#39;)
transactions_data = pd.read_csv(&#39;data/transactions.csv&#39;)</code></pre>
<pre><code>## sys:1: DtypeWarning: Columns (6) have mixed types.Specify dtype option on import or set low_memory=False.</code></pre>
<pre class="python"><code>accounts_data = accounts_data[~pd.isna(accounts_data[&#39;loan_date&#39;])]

mean_bal = transactions_data.groupby(&#39;account_id&#39;)[&#39;balance&#39;].mean().round(2).reset_index().rename(columns = {&#39;balance&#39; : &#39;avg_bank_balance&#39;})
accounts_data = accounts_data.merge(mean_bal, how = &#39;left&#39;, on = &#39;account_id&#39;) 

# make loan date
accounts_data[&#39;loan_date&#39;] = accounts_data.loan_date.astype(&#39;datetime64[D]&#39;)
# convert to monthly period
accounts_data[&#39;loan_monthly&#39;] = accounts_data.loan_date.dt.to_period(&#39;M&#39;)
# calculate difference between loan date and account creation date as years
accounts_data[&#39;account_loan_diff&#39;] = (accounts_data.loan_date.astype(&#39;datetime64[D]&#39;) - accounts_data.acct_creation_date.astype(&#39;datetime64[D]&#39;)).dt.days / 365

# create monthly dataframe for time series plots
accounts_data_monthly = accounts_data[accounts_data[&#39;loan_default&#39;] == True].groupby(&#39;loan_monthly&#39;)[&#39;loan_amount&#39;].sum().reset_index()
accounts_data_monthly[&#39;loan_date&#39;] = pd.PeriodIndex(accounts_data_monthly.loan_monthly).to_timestamp()</code></pre>
<p>The first plot shows the distribution of loan amounts</p>
<pre class="python"><code>ax = sns.displot(accounts_data, x=&quot;loan_amount&quot;)
plt.title(&quot;Distribution of loan amounts&quot;)
plt.ylabel(&#39;Count&#39;)
plt.xlabel(&#39;Loan amount&#39;)
plt.tight_layout()
plt.show()</code></pre>
<p><img src="task2_files/figure-html/unnamed-chunk-2-1.png" width="480" /></p>
<p>The next plot considers whether current or past loans are bigger. This will show whether the bank is taking on larger or smaller loans now.</p>
<pre class="python"><code>
ax = sns.displot(accounts_data, x=&quot;loan_amount&quot;, hue=&quot;loan_status&quot;, element=&quot;step&quot;)
plt.title(&quot;Distribution of loan amounts colored by loan status&quot;)
plt.ylabel(&#39;count&#39;)
plt.xlabel(&#39;Loan amount&#39;)
plt.tight_layout()
plt.show()</code></pre>
<p><img src="task2_files/figure-html/unnamed-chunk-3-1.png" width="578" /></p>
<p>The next plot considers how the total loan origination has changed over time. The monthly time series plot shows the total loans given out. We see that there were three broad spikes in defaults in 1994, 1996, and 1997.</p>
<pre class="python"><code>fig, ax = plt.subplots()
sns.set_style(&quot;ticks&quot;)
sns.lineplot(data=accounts_data_monthly,x=&quot;loan_date&quot;, y=&quot;loan_amount&quot;, ax=ax)
plt.title(&quot;Monthly time series total loan amount&quot;)
plt.ylabel(&quot;total loan amount&quot;)
plt.xlabel(&quot;&quot;)
plt.show()</code></pre>
<p><img src="task2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
